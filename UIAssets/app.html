<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="locale" content="US">
        <meta name="language" content="en">
        <meta name="country" content="US">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link type="text/css" rel="stylesheet" href="css/cui-1.3.1-official/css/cui-standard.min.css">
        <script type='text/javascript' src='js/lib/jquery-3.1.1.min.js'></script>
        <script type='text/javascript' src='js/lib/json2.js'></script>
        <script type='text/javascript' src='js/lib/js.cookie.js'></script>
        <script type='text/javascript' src='js/lib/knockout-3.4.2.js'></script>
        <script type='text/javascript' src='js/lib/moment.min.js'></script>
        <script type='text/javascript' src='js/common.js'></script>
        <script type='text/javascript' src='js/app.js'></script>
    </head>
    <body class="cui">
    
    <!-- single modal backdrop required -->
    <div class="modal-backdrop hide"></div>

    <!-- common alert modal -->
    <div class="modal modal-alert modal--small hide">
        <div class="modal__dialog">
            <div class="modal__content">
                <div class="modal__body">
                    <div class="alert alert--warning">
                        <div class="alert__icon icon-warning-outline"></div>
                        <div class="alert__message text-left">
                            <div class="half-margin-top">
                                <span class="text-large text-warning">Warning</span>
                                <p id="modal-alert-content"></p>
                            </div>
                            <div class="text-center base-margin-top">
                                <button class="btn btn--small btn--gray-ghost" onclick="hideModal()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- common info modal -->
    <div class="modal modal-info modal--large hide">
        <div class="modal__dialog">
            <div class="modal__content">
                <a class="modal__close" onclick="hideModal()"><span class="icon-close"></span></a>
                <div class="modal__body">
                    <div class="alert">
                        <div class="alert__icon icon-info-outline"></div>
                        <div class="alert__message text-left">
                            <div class="half-margin-top">
                                <p id="modal-info-content"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal__footer">
                    <button class="btn btn btn--gray-ghost" onclick="hideModal()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- modal form for editing/creating fabric -->
    <div class="modal modal-form modal--large hide">
        <div class="modal__dialog">
            <div class="modal__content">
                <a class="modal__close" onclick="hideModal()"><span class="icon-close"></span></a>
                <div class="modal__header">
                    <h3 class="modal__title">Fabric Settings</h3>
                </div>
                <div class="modal__body">
					<div class="row">
						<div class="col-md-2"></div>
						<div class="col-md-8">
						    <div class="form-group label--inline">
						        <div class="form-group__text">
						            <input type="text" data-bind="value: fabric.fabric, disable: fabric.init">
						            <label class="col-3" for="fabric">Fabric</label>
						        </div>
						    </div>
						    <div class="form-group label--inline">
						        <div class="form-group__text">
						            <input type="text" data-bind="value: fabric.apic_hostname, disable: fabric.apic_cert().length>0">
						            <label class="col-3" for="apic_hostname">APIC Hostname</label>
						        </div>
						    </div>
						    <div class="form-group label--inline">
						        <div class="form-group__text">
						            <input type="text" data-bind="value: fabric.apic_username, disable: fabric.apic_cert().length>0">
						            <label class="col-3" for="apic_username">APIC Username</label>
						        </div>
						    </div>
						    <div class="form-group label--inline" data-bind="visible: fabric.apic_cert().length==0">
						        <div class="form-group__text">
						            <input type="password" data-bind="value: fabric.apic_password">
						            <label class="col-3" for="apic_password">APIC Password</label>
						        </div>
						    </div>
						    <div class="form-group label--inline" data-bind="visible: fabric.apic_cert().length>0">
						        <div class="form-group__text">
						            <input type="text" data-bind="value: fabric.apic_cert, disable: true">
						            <label class="col-3" for="apic_cert">APIC Certificate</label>
						        </div>
						    </div>
						    <div class="form-group label--inline">
						        <div class="form-group__text">
						            <input type="text" data-bind="value: fabric.ssh_username">
						            <label class="col-3" for="ssh_username">SSH Username</label>
						        </div>
						    </div>
						    <div class="form-group label--inline">
						        <div class="form-group__text">
						            <input type="password" data-bind="value: fabric.ssh_password">
						            <label class="col-3" for="ssh_password">SSH Password</label>
						        </div>
						    </div>
                        </div>
						<div class="col-md-2"></div>
					</div>
                </div>
                <div class="modal__footer" data-bind="loadingWhen: fabric.formLoading">
                    <button class="btn btn--primary" data-bind="click: fabric.save">Submit</button>
                    <button class="btn btn--gray-ghost" onclick="hideModal()">Close</button>
                </div>
            </div>
        </div>
    </div>

    
    <!-- page header -->
    <header class="header header--compressed">
        <div class="header-bar container">
            <a href="javascript:;" class="header-bar__logo">
                <span class="icon-cisco"></span>
            </a>
            <div class="header-bar__main">
                <div class="header-heading">
                    <h1 class="page-title">CSCvf18506 Workaround</h1>
                </div>
            </div>
        </div>
    </header>

    <div class="content-fluid">
        <main style="display:none">
            <div class="content content--alt">
                <div class="container">
                    <div class="section">


        
<!-- main content start -->
<div data-bind="loadingWhen: isLoading">
    <!-- info when no fabric is configured -->
    <div data-bind="visible: !fabric.init()">
        <div class="alert alert--info">
            <div class="alert__icon icon-warning-outline"></div>
            <div class="alert__message">
                <div class="clearfix">
                <div class="pull-left"><h5>No fabric configured</h5></div>
                <div class="pull-right">                     
                    <button class="btn btn--small  btn--primary" data-bind="click: showModalForm">
                        Add a fabric to monitor
                    </button>
                </div>
                </div>
            </div>
        </div>
    </div>
    <!-- display fabric state -->
    <div data-bind="visible: fabric.init">
        <div class="card card--raised">
            <div class="card__header">
                <div class="clearfix">
                    <div class="pull-left text-xlarge">
                        <span class="text-bold">Fabric</span>
                        <span data-bind="text: fabric.fabric"></span>
                    </div>
                    <div class="pull-right">
                        <ul class="list list--inline list--compressed ">
                            <li>
                                <span tabindex="0" data-balloon="edit" data-balloon-pos="down">
                                    <button class="btn btn--icon btn--small" 
                                        data-bind="click: showModalForm">
                                        <span class="icon-tools"></span>
                                    </button>
                                </span>
                            </li>
                            <li>
                                <span tabindex="0" data-balloon="refresh status" data-balloon-pos="down">
                                    <button class="btn btn--icon btn--small" 
                                        data-bind="click: fabric.refresh_state, css: fabric.isLoading()?'disabled':''">
                                        <span class="icon-redial"></span>
                                    </button>
                                </span>
                            </li>
                            <li>
                                <span tabindex="0" data-balloon="start monitor" data-balloon-pos="down">
                                    <button class="btn btn--icon btn--small btn--primary" 
                                        data-bind="click: fabric.start, css: fabric.isLoading()?'disabled':''">
                                        <span class="icon-play"></span>
                                    </button>
                                </span>
                            </li>
                            <li>
                                <span tabindex="0" data-balloon="stop monitor" data-balloon-pos="down">
                                    <button class="btn btn--icon btn--small btn--negative" 
                                        data-bind="click: fabric.stop, css: fabric.isLoading()?'disabled':''">
                                        <span class="icon-close"></span>
                                    </button>
                                </span>
                            </li>
                        </ul>

                    </div>
                </div>
            </div>
            <div class="card__body" data-bind="loadingWhen: fabric.isLoading">
                <div class="base-margin-bottom flex-center-vertial" > 
                    <span class="label text-large" data-bind="css: fabric.status_running()?'label--success':'label--warning'">
                        <span class="icon-small" data-bind="css: fabric.status_running()?'icon-check':'icon-warning-outline'"></span>
                        <span class="text-bold half-padding-left" data-bind="text: fabric.status"></span>
                    </span>

                    <button class="btn btn--small btn--secondary pull-right" data-bind="click: toggle_fabric_events">
                        <span class="label label--circle label--blue" data-bind="text: fabric.event_count"></span>
                        <span data-bind="text: show_fabric_events()?'Hide Events':'View Events'"></span>
                    </button>
                </div>
                <div data-bind="visible: show_fabric_events() && !fabric.isLoading()" class="responsive-table">

                    <div data-bind="visible: fabric.events().length>fabric.max_events()">
                        <h5>Events limited to last <span data-bind="text: fabric.max_events"></span> events</h5>
                    </div>
                    <div class="timeline">
                        <div class="timeline__list" data-bind="foreach: { data: fabric.events, as: 'fevent'}">
                            <div class="timeline__item">
                                <div class="timeline__icon" data-bind="css: fevent.timeline_status"></div>
                                <div class="timeline__time" data-bind="text: fevent.ts"></div>
                                <div class="timeline__content">
                                    <div class="text-bold" data-bind="text: fevent.status"></div>
                                    <div data-bind="text: fevent.description"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="card__footer"></div>
        </div>
    </div>


    <!-- display fabric nodes (limited to spines) -->
    <div data-bind="visible: fabric.init" class="base-margin-top">
        <div class="card card--raised">
            <div class="card__header">
                <div class="clearfix">
                    <div class="pull-left text-xlarge flex-center-vertical">
                        <span class="label label--circle label--blue" data-bind="text: fabric.nodes().length"></span>
                        <span class="text-bold half-margin-left">Spines</span>

                    </div>
                    <div class="pull-right">
                        <ul class="list list--inline list--compressed ">
                            <li>
                                <span tabindex="0" data-balloon="refresh spines" data-balloon-pos="down">
                                    <button class="btn btn--icon btn--small" 
                                        data-bind="click: fabric.get_nodes, css: fabric.isLoading()?'disabled':''">
                                        <span class="icon-redial"></span>
                                    </button>
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
            <div class="card__body" data-bind="loadingWhen: fabric.nodesLoading">
                <!-- info when no spines have been discovered -->
                <div data-bind="visible: fabric.nodes().length==0">
                    <div class="alert alert--info">
                        <div class="alert__icon icon-warning-outline"></div>
                        <div class="alert__message">
                            No spines have been discovered.  Start the fabric monitor to discover spines.
                        </div>
                    </div>
                </div>

                <div class="responsive-table base-margin-bottom" data-bind="visible: fabric.nodes().length>0">
                    <table class="table table--hover">
                        <thead> 
                            <tr>    
                                <th>Name</th>
                                <th>Pod</th>
                                <th>Node</th>
                                <th>Model</th>
                                <th>Status</th>
                                <th>Linecards</th>
                                <th>Events</th>
                                <th>Pokes</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach: { data: fabric.nodes, as: 'node'}">
                            <tr>
                                <td data-bind="text: node.name"></td>
                                <td data-bind="text: node.pod_id"></td>
                                <td data-bind="text: node.node_id"></td>
                                <td data-bind="text: node.model"></td>
                                <td data-bind="text: node.status"></td>
                                <td>
                                    <span class="label label--circle label--blue" data-bind="text: node.linecards().length"></span>
                                </td>
                                <td>
                                    <span class="label label--circle label--blue" data-bind="text: node.total_events"></span>
                                </td>
                                <td>
                                    <span class="label label--circle" 
                                        data-bind="text: node.pokes, css: node.pokes()==0?'':'label--warning'">
                                    </span>
                                </td>
                                <td data-bind="loadingWhen: node.isLoading">
                                    <button class="btn btn--icon btn--small btn--secondary" 
                                        data-bind="click: node.show_events">
                                        <span class="icon-search"></span>
                                    </button>
                                    <button class="btn btn--icon btn--small btn--primary" 
                                        data-bind="click: node.ondemand_verify">
                                        <span class="icon-forced-sign-in"></span>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card__footer"></div>
        </div>
    </div>


</div>



<!-- main content end -->
                    </div>
                </div>
            </div>
        </main>
    </div>
    </body>
</html>

